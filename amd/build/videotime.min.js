define(["jquery","mod_videotime/player","core/ajax","core/log"],function(a,b,c,d){return{init:function(a,e,f){var g=new b("vimeo-embed",{responsive:1});if(f){var h=!1,i=0,j=0;g.on("play",function(){h=!0,d.debug("VIDEO_TIME play")}),g.on("playing",function(){h=!0,d.debug("VIDEO_TIME playing")}),g.on("pause",function(){h=!1,d.debug("VIDEO_TIME pause")}),g.on("stalled",function(){h=!1,d.debug("VIDEO_TIME stalled")}),g.on("suspend",function(){h=!1,d.debug("VIDEO_TIME suspend")}),g.on("abort",function(){h=!1,d.debug("VIDEO_TIME abort")}),g.on("ended",function(){h=!1,d.debug("VIDEO_TIME ended"),c.call([{methodname:"videotimeplugin_pro_set_session_state",args:{session_id:a.id,state:1}}]),c.call([{methodname:"videotimeplugin_pro_set_percent",args:{session_id:a.id,percent:1}}])}),g.on("timeupdate",function(a){h=!0,j=a.percent,d.debug("VIDEO_TIME timeupdate")}),setInterval(function(){h&&(i++,i%e===0&&(d.debug("VIDEO_TIME watch_time: "+i+". percent: "+j),c.call([{methodname:"videotimeplugin_pro_record_watch_time",args:{session_id:a.id,time:i}}]),c.call([{methodname:"videotimeplugin_pro_set_percent",args:{session_id:a.id,percent:j}}])))},1e3)}}}});