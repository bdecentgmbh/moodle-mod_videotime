define("mod_videotime/resize_tab_player",["exports","mod_videotime/player","core/notification"],(function(_exports,_player,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/*
   * Position the Vimeo player within tab layout
   *
   * @package    mod_videotime
   * @module     mod_videotime/resize_tab_player
   * @copyright  2021 bdecent gmbh <https://bdecent.de>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */let column;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initialize=void 0,_player=_interopRequireDefault(_player),_notification=_interopRequireDefault(_notification);_exports.initialize=()=>{let observer=new ResizeObserver(resize);new MutationObserver(resize).observe(document.body,{subtree:!0,childList:!0}),document.querySelectorAll(".instance-container, div.videotime-tab-instance").forEach((container=>{observer.observe(container)})),document.querySelectorAll(".videotime-tab-instance").forEach((instance=>{instance.style.position="absolute"})),resize(),window.removeEventListener("mousemove",mousemoveHandler),window.addEventListener("mousemove",mousemoveHandler),window.removeEventListener("dragstart",dragstartHandler),window.addEventListener("dragstart",dragstartHandler),window.removeEventListener("mouseup",dragendHandler),window.addEventListener("mouseup",dragendHandler),window.removeEventListener("click",cueVideo),window.addEventListener("click",cueVideo)};const resize=()=>{document.querySelectorAll(".instance-container").forEach((container=>{container.offsetWidth&&container.closest(".videotimetabs").querySelectorAll(".videotime-tab-instance").forEach((instance=>{let content=container.closest(".videotimetabs").querySelector(".tab-content"),i=0;Object.assign(instance.style,{top:container.offsetTop+"px",left:container.offsetLeft+"px",maxWidth:container.offsetWidth+"px",width:container.offsetWidth+"px"}),container.closest(".videotimetabs").querySelectorAll("ul .nav-link").forEach((tab=>{i++,tab.classList.contains("active")&&instance.setAttribute("data-tab",i)})),container.style.minHeight=instance.offsetHeight+5+"px",container.closest(".videotimetabs").querySelectorAll(".videotime-tab-instance-cover").forEach((cover=>{Object.assign(cover.style,{height:content.offsetHeight+"px",left:content.offsetLeft+"px",top:content.offsetTop+"px",width:content.offsetWidth+"px"})}))}))}))},dragendHandler=()=>{document.querySelectorAll(".videotime-tab-instance-cover").forEach((cover=>{cover.style.display="none"}))},dragstartHandler=e=>{e.target.classList.contains("videotimetab-resize-handle")&&(column=e.target.closest(".tab-pane").querySelector(".videotimetab-resize"),e.stopPropagation(),e.preventDefault(),document.querySelectorAll(".videotime-tab-instance-cover").forEach((cover=>{cover.style.display="block"})))},mousemoveHandler=e=>{document.querySelectorAll(".videotimetab-resize-handle").forEach((h=>{h.closest(".tab-pane")&&"block"==document.querySelector(".videotime-tab-instance-cover").style.display&&(column.style.width=e.pageX-column.getBoundingClientRect().left+"px")}))},cueVideo=async e=>{if(e.target.closest('[data-action="cue"]')){const time=e.target.closest("a").getAttribute("data-start").match(/((([0-9]+):)?(([0-9]+):))?([0-9]+(\.[0-9]+)?)/),iframe=e.target.closest(".videotimetabs").querySelector(".vimeo-embed iframe");if(iframe){const player=new _player.default(iframe);if(e.preventDefault(),e.stopPropagation(),time)try{await player.setCurrentTime(3600*Number(time[3]||0)+60*Number(time[5]||0)+Number(time[6])),player.play()}catch(e){_notification.default.exception(e)}}else{const player=e.target.closest(".videotimetabs").querySelector("video");e.preventDefault(),e.stopPropagation(),player.currentTime=3600*Number(time[3]||0)+60*Number(time[5]||0)+Number(time[6])}}}}));

//# sourceMappingURL=resize_tab_player.min.js.map