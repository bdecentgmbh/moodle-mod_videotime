define(["mod_videotime/player","core/notification"],function(e,t){var o=function(){this.initialize()};return o.prototype.column="",o.prototype.initialize=function(){let e=new ResizeObserver(this.resize);new MutationObserver(this.resize).observe(document.querySelector("#page-content"),{subtree:!0,childList:!0}),document.querySelectorAll(".instance-container, div.videotime-tab-instance").forEach(t=>{e.observe(t)}),this.resize(),document.querySelectorAll(".videotime-tab-instance").forEach(e=>{e.style.position="absolute"}),window.removeEventListener("mousemove",this.mousemoveHandler),window.addEventListener("mousemove",this.mousemoveHandler),window.removeEventListener("dragstart",this.dragstartHandler),window.addEventListener("dragstart",this.dragstartHandler),window.removeEventListener("mouseup",this.dragendHandler),window.addEventListener("mouseup",this.dragendHandler),window.removeEventListener("click",this.cueVideo),window.addEventListener("click",this.cueVideo)},o.prototype.resize=function(){document.querySelectorAll(".instance-container").forEach(e=>{e.offsetWidth&&e.closest(".videotimetabs").querySelectorAll(".videotime-tab-instance .vimeo-embed iframe").forEach(t=>{let o=t.closest(".videotime-tab-instance"),i=t.closest(".tab-content");Object.assign(o.style,{top:e.offsetTop+"px",left:e.offsetLeft+"px",width:e.offsetWidth+"px"}),e.style.minHeight=t.closest(".videotime-tab-instance").offsetHeight+"px",i.querySelectorAll(".videotime-tab-instance-cover").forEach(e=>{Object.assign(e.style,{height:i.offsetHeight+"px",left:i.offsetLeft+"px",top:i.offsetTop+"px",width:i.offsetWidth+"px"})})})})},o.prototype.dragendHandler=function(){document.querySelectorAll(".videotime-tab-instance-cover").forEach(e=>{e.style.display="none"})},o.prototype.dragstartHandler=function(e){e.target.classList.contains("videotimetab-resize-handle")&&(this.column=e.target.closest(".tab-pane").querySelector(".videotimetab-resize"),e.stopPropagation(),e.preventDefault(),document.querySelectorAll(".videotime-tab-instance-cover").forEach(e=>{e.style.display="block"}))},o.prototype.mousemoveHandler=function(e){document.querySelectorAll(".videotimetab-resize-handle").forEach(t=>{t.closest(".tab-pane")&&"block"==document.querySelector(".videotime-tab-instance-cover").style.display&&(this.column.style.width=e.pageX-column.getBoundingClientRect().left+"px")})},o.prototype.cueVideo=function(o){if(o.target.matches('[data-action="cue"]')){let i=o.target.closest("a").getAttribute("data-start").match(/((([0-9]+):)?(([0-9]+):))?([0-9]+(\.[0-9]+))/),n=o.target.closest(".videotimetabs").querySelector(".vimeo-embed iframe"),r=new e(n);o.preventDefault(),o.stopPropagation(),i&&r.setCurrentTime(3600*Number(i[3]||0)+60*Number(i[5]||0)+Number(i[6])).then(r.play.bind(r)).catch(t.exception)}},{init:function(){return new o}}});