{"version":3,"sources":["../src/selecttrack.js"],"names":["define","selectTrack","initialize","prototype","self","url","URL","window","location","href","lang","searchParams","get","removeEventListener","handleChange","bind","document","querySelectorAll","forEach","form","querySelector","setAttribute","setLanguage","addEventListener","event","target","closest","stopPropagation","preventDefault","data","FormData","row","getAttribute","style","display","init"],"mappings":"AAwBCA,OAAM,sCAAC,EAAD,CAAK,UAAW,CAEnB,GAAIC,CAAAA,CAAW,CAAG,UAAW,CACzB,KAAKC,UAAL,EACH,CAFD,CAOAD,CAAW,CAACE,SAAZ,CAAsBD,UAAtB,CAAmC,UAAW,IACtCE,CAAAA,CAAI,CAAG,IAD+B,CAEtCC,CAAG,CAAG,GAAIC,CAAAA,GAAJ,CAAQC,MAAM,CAACC,QAAP,CAAgBC,IAAxB,CAFgC,CAG1CC,CAAI,CAAGL,CAAG,CAACM,YAAJ,CAAiBC,GAAjB,CAAqB,MAArB,CAHmC,CAK1CL,MAAM,CAACM,mBAAP,CAA2B,QAA3B,CAAqCT,CAAI,CAACU,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAArC,EACAC,QAAQ,CAACC,gBAAT,CAA0B,wCAA1B,EAAoEC,OAApE,CAA4E,SAACC,CAAD,CAAU,CAClF,GAAIT,CAAJ,CAAU,CACNS,CAAI,CAACC,aAAL,CAAmB,yBAA0BV,CAA1B,CAAiC,KAApD,EAA0DW,YAA1D,CAAuE,UAAvE,IACH,CACDjB,CAAI,CAACkB,WAAL,CAAiBH,CAAjB,CACH,CALD,EAMAZ,MAAM,CAACgB,gBAAP,CAAwB,QAAxB,CAAkCnB,CAAI,CAACU,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAAlC,CACH,CAbD,CAoBAd,CAAW,CAACE,SAAZ,CAAsBW,YAAtB,CAAqC,SAASU,CAAT,CAAgB,IAC7CpB,CAAAA,CAAI,CAAG,IADsC,CAE7Ce,CAAI,CAAGK,CAAK,CAACC,MAAN,CAAaC,OAAb,CAAqB,wCAArB,CAFsC,CAGjD,GAAIP,CAAJ,CAAU,CACNK,CAAK,CAACG,eAAN,GACAH,CAAK,CAACI,cAAN,GACAxB,CAAI,CAACkB,WAAL,CAAiBH,CAAjB,CACH,CACJ,CARD,CAeAlB,CAAW,CAACE,SAAZ,CAAsBmB,WAAtB,CAAoC,SAASH,CAAT,CAAe,CAC/C,GAAIU,CAAAA,CAAI,CAAG,GAAIC,CAAAA,QAAJ,CAAaX,CAAb,CAAX,CACAA,CAAI,CAACO,OAAL,CAAa,WAAb,EAA0BT,gBAA1B,CAA2C,kBAA3C,EAA+DC,OAA/D,CAAuE,SAACa,CAAD,CAAS,CAC5E,GAAIA,CAAG,CAACC,YAAJ,CAAiB,WAAjB,GAAiCH,CAAI,CAACjB,GAAL,CAAS,MAAT,CAArC,CAAuD,CACnDmB,CAAG,CAACE,KAAJ,CAAUC,OAAV,CAAoB,IACvB,CAFD,IAEO,CACHH,CAAG,CAACE,KAAJ,CAAUC,OAAV,CAAoB,MACvB,CACJ,CAND,CAOH,CATD,CAWA,MAAO,CACHC,IAAI,CAAG,eAAW,CACd,MAAO,IAAIlC,CAAAA,CACd,CAHE,CAKT,CA5DK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Show selected text track\n *\n * @package    mod_videotime\n * @module     mod_videotime/selecttrrack\n * @copyright  2021 bdecent gmbh <https://bdecent.de>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n define([], function() {\n\n    var selectTrack = function() {\n        this.initialize();\n    };\n\n    /**\n     * Intialize listener and show current track\n     */\n    selectTrack.prototype.initialize = function() {\n        var self = this;\n        let url = new URL(window.location.href),\n        lang = url.searchParams.get('lang');\n\n        window.removeEventListener('change', self.handleChange.bind(this));\n        document.querySelectorAll('form.videotimetab_texttrack_selectlang').forEach((form) => {\n            if (lang) {\n                form.querySelector('select option[value=\"' + lang + '\"]').setAttribute('selected', true);\n            }\n            self.setLanguage(form);\n        });\n        window.addEventListener('change', self.handleChange.bind(this));\n    };\n\n    /**\n     * Form change event handler\n     *\n     * @param {event} e mouse event\n     */\n    selectTrack.prototype.handleChange = function(event) {\n        var self = this;\n        let form = event.target.closest('form.videotimetab_texttrack_selectlang');\n        if (form) {\n            event.stopPropagation();\n            event.preventDefault();\n            self.setLanguage(form);\n        }\n    };\n\n    /**\n     * Show lang indicate by form\n     *\n     * @param {element} form\n     */\n    selectTrack.prototype.setLanguage = function(form) {\n        let data = new FormData(form);\n        form.closest('.tab-pane').querySelectorAll('.texttracks .row').forEach((row) => {\n            if (row.getAttribute('data-lang') == data.get('lang')) {\n                row.style.display = null;\n            } else {\n                row.style.display = 'none';\n            }\n        });\n    };\n\n    return {\n        init : function() {\n            return new selectTrack();\n        }\n    };\n });\n"],"file":"selecttrack.min.js"}